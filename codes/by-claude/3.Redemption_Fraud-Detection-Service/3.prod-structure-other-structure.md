# üöÄ Sub-Project 3: Redemption & Transaction Service - Complete Implementation Guide

## üìã **B·∫¢NG T·ªîNG H·ª¢P T·∫§T C·∫¢ FILES V√Ä REFERENCES**

| **Category** | **File Path** | **M√¥ t·∫£** | **SRS Reference** | **Business Purpose** |
|-------------|---------------|-----------|-------------------|-------------------|
| **üì¶ SHARED PACKAGES** | | | | |
| Core Package | `@psp/shared-core@1.2.0` | Common utilities package | Part02.8 Technical Requirements | Cross-service utilities (logger, validation, crypto) |
| Events Package | `@psp/shared-events@1.1.0` | Domain events contracts | Part06.1.2 Event Bus | Event-driven communication between services |
| Database Package | `@psp/shared-database@1.0.5` | Database utilities | Part07.1 Data Model Overview | DB connection management, migrations |
| **üóÉÔ∏è BACKEND DOMAIN** | | | | |
| Entities | `backend/src/domain/entities/Redemption.ts` | Core redemption entity v·ªõi business rules | Part04.3.1 Barcode Redemption (FR-007) | Encapsulate redemption logic, state management |
| Entities | `backend/src/domain/entities/Transaction.ts` | Transaction entity with payment processing | Part04.3.1 Barcode Redemption | Transaction lifecycle management |
| Entities | `backend/src/domain/entities/FraudScore.ts` | Fraud detection entity with ML scoring | Part04.3.5 Fraud Detection (FR-011) | ML-based fraud prevention |
| Entities | `backend/src/domain/entities/DeviceFingerprint.ts` | Device fingerprinting entity | Part04.3.5 Fraud Detection | Device identification and tracking |
| Entities | `backend/src/domain/entities/RedemptionAudit.ts` | Audit log entity for compliance | Part05.6 Audit & Compliance | Transaction audit trail |
| Entities | `backend/src/domain/entities/BarcodeValidation.ts` | Barcode validation entity | Part04.3.1 Barcode Redemption | QR/barcode verification logic |
| Entities | `backend/src/domain/entities/OfflineRedemption.ts` | Offline redemption entity | Part04.3.1 Barcode Redemption | Offline sync management |
| Entities | `backend/src/domain/entities/POSIntegration.ts` | POS system integration entity | Part09.2 POS Integration | Point-of-sale system connectivity |
| Value Objects | `backend/src/domain/value-objects/BarcodeValue.ts` | Barcode value object with validation | Part04.3.1 Barcode Redemption | QR/barcode format validation |
| Value Objects | `backend/src/domain/value-objects/TransactionAmount.ts` | Transaction amount value object | Part04.3.1 Barcode Redemption | Amount validation and currency handling |
| Value Objects | `backend/src/domain/value-objects/FraudRiskLevel.ts` | Fraud risk assessment value object | Part04.3.5 Fraud Detection | Risk categorization (Low/Medium/High) |
| Value Objects | `backend/src/domain/value-objects/RedemptionStatus.ts` | Redemption status management | Part04.3.1 Barcode Redemption | Status transitions (Pending/Success/Failed) |
| Value Objects | `backend/src/domain/value-objects/DeviceIdentifier.ts` | Device identification value object | Part04.3.5 Fraud Detection | Unique device tracking |
| Repositories | `backend/src/domain/repositories/IRedemptionRepository.ts` | Redemption repository interface | Part06.2.1 Layered Architecture | Redemption data access contract |
| Repositories | `backend/src/domain/repositories/ITransactionRepository.ts` | Transaction repository interface | Part06.2.1 Layered Architecture | Transaction storage contract |
| Repositories | `backend/src/domain/repositories/IFraudScoreRepository.ts` | Fraud score repository interface | Part06.2.1 Layered Architecture | Fraud data access contract |
| Repositories | `backend/src/domain/repositories/IDeviceFingerprintRepository.ts` | Device fingerprint repository interface | Part06.2.1 Layered Architecture | Device tracking contract |
| Repositories | `backend/src/domain/repositories/IRedemptionAuditRepository.ts` | Audit repository interface | Part06.2.1 Layered Architecture | Audit log storage contract |
| Repositories | `backend/src/domain/repositories/IBarcodeValidationRepository.ts` | Barcode validation repository interface | Part06.2.1 Layered Architecture | Barcode verification contract |
| Repositories | `backend/src/domain/repositories/IOfflineRedemptionRepository.ts` | Offline redemption repository interface | Part06.2.1 Layered Architecture | Offline sync storage contract |
| Domain Services | `backend/src/domain/services/RedemptionDomainService.ts` | Redemption business logic service | Part04.3.1 Barcode Redemption | Complex redemption workflows |
| Domain Services | `backend/src/domain/services/FraudDetectionDomainService.ts` | Fraud detection business logic | Part04.3.5 Fraud Detection | ML fraud scoring algorithms |
| Domain Services | `backend/src/domain/services/BarcodeValidationDomainService.ts` | Barcode validation service | Part04.3.1 Barcode Redemption | QR/barcode verification logic |
| Domain Services | `backend/src/domain/services/DeviceFingerprintDomainService.ts` | Device fingerprinting service | Part04.3.5 Fraud Detection | Device identification algorithms |
| Domain Services | `backend/src/domain/services/TransactionDomainService.ts` | Transaction processing service | Part04.3.1 Barcode Redemption | Payment processing logic |
| **üìÑ BACKEND APPLICATION** | | | | |
| Use Cases | `backend/src/application/use-cases/redemption/ProcessRedemptionUseCase.ts` | Main redemption processing workflow | Part04.3.1 Barcode Redemption (FR-007) | End-to-end redemption flow |
| Use Cases | `backend/src/application/use-cases/redemption/ValidateBarcodeUseCase.ts` | Barcode validation workflow | Part04.3.1 Barcode Redemption | QR/barcode verification process |
| Use Cases | `backend/src/application/use-cases/redemption/ProcessOfflineRedemptionUseCase.ts` | Offline redemption processing | Part04.3.1 Barcode Redemption | Offline sync and validation |
| Use Cases | `backend/src/application/use-cases/redemption/GetRedemptionStatusUseCase.ts` | Redemption status tracking | Part04.3.1 Barcode Redemption | Status monitoring and updates |
| Use Cases | `backend/src/application/use-cases/redemption/CancelRedemptionUseCase.ts` | Redemption cancellation logic | Part04.3.1 Barcode Redemption | Transaction reversal workflow |
| Use Cases | `backend/src/application/use-cases/transaction/CreateTransactionUseCase.ts` | Transaction creation workflow | Part04.3.1 Barcode Redemption | Payment transaction processing |
| Use Cases | `backend/src/application/use-cases/transaction/ProcessPaymentUseCase.ts` | Payment processing workflow | Part04.3.1 Barcode Redemption | Payment gateway integration |
| Use Cases | `backend/src/application/use-cases/transaction/RefundTransactionUseCase.ts` | Transaction refund logic | Part04.3.1 Barcode Redemption | Refund processing workflow |
| Use Cases | `backend/src/application/use-cases/transaction/GetTransactionHistoryUseCase.ts` | Transaction history retrieval | Part04.3.1 Barcode Redemption | Transaction audit and reporting |
| Use Cases | `backend/src/application/use-cases/fraud/CalculateFraudScoreUseCase.ts` | Fraud score calculation | Part04.3.5 Fraud Detection (FR-011) | ML-based fraud assessment |
| Use Cases | `backend/src/application/use-cases/fraud/ProcessFraudAlertUseCase.ts` | Fraud alert processing | Part04.3.5 Fraud Detection | Fraud incident management |
| Use Cases | `backend/src/application/use-cases/fraud/CreateDeviceFingerprintUseCase.ts` | Device fingerprint creation | Part04.3.5 Fraud Detection | Device identification process |
| Use Cases | `backend/src/application/use-cases/fraud/CheckDeviceRiskUseCase.ts` | Device risk assessment | Part04.3.5 Fraud Detection | Device-based risk evaluation |
| Use Cases | `backend/src/application/use-cases/fraud/UpdateFraudRulesUseCase.ts` | Fraud rules management | Part04.3.5 Fraud Detection | Dynamic fraud rule updates |
| Use Cases | `backend/src/application/use-cases/audit/CreateAuditLogUseCase.ts` | Audit log creation | Part05.6 Audit & Compliance | Compliance audit trail |
| Use Cases | `backend/src/application/use-cases/audit/GetAuditTrailUseCase.ts` | Audit trail retrieval | Part05.6 Audit & Compliance | Audit reporting and investigation |
| Use Cases | `backend/src/application/use-cases/pos/SyncPOSDataUseCase.ts` | POS data synchronization | Part09.2 POS Integration | Point-of-sale data sync |
| Use Cases | `backend/src/application/use-cases/pos/ProcessOfflinePOSUseCase.ts` | Offline POS processing | Part09.2 POS Integration | Offline POS transaction handling |
| DTOs | `backend/src/application/dto/RedemptionDTO.ts` | Redemption data transfer objects | Part08.3.1 Redemption APIs | API contract definitions |
| DTOs | `backend/src/application/dto/TransactionDTO.ts` | Transaction data transfer objects | Part08.3.1 Redemption APIs | Transaction API contracts |
| DTOs | `backend/src/application/dto/FraudDTO.ts` | Fraud detection data transfer objects | Part08.3.2 Fraud Detection APIs | Fraud API contracts |
| DTOs | `backend/src/application/dto/BarcodeDTO.ts` | Barcode data transfer objects | Part08.3.1 Redemption APIs | Barcode API contracts |
| DTOs | `backend/src/application/dto/AuditDTO.ts` | Audit data transfer objects | Part08.3.1 Redemption APIs | Audit API contracts |
| DTOs | `backend/src/application/dto/POSDTO.ts` | POS data transfer objects | Part08.3.1 Redemption APIs | POS integration contracts |
| Command Handlers | `backend/src/application/handlers/ProcessRedemptionHandler.ts` | CQRS redemption command handler | Part06.2.3 CQRS Pattern | Command processing for redemptions |
| Command Handlers | `backend/src/application/handlers/ProcessTransactionHandler.ts` | CQRS transaction command handler | Part06.2.3 CQRS Pattern | Command processing for transactions |
| Command Handlers | `backend/src/application/handlers/FraudDetectionHandler.ts` | CQRS fraud detection command handler | Part06.2.3 CQRS Pattern | Command processing for fraud detection |
| Query Handlers | `backend/src/application/handlers/GetRedemptionQueryHandler.ts` | CQRS redemption query handler | Part06.2.3 CQRS Pattern | Query processing for redemptions |
| Query Handlers | `backend/src/application/handlers/GetTransactionQueryHandler.ts` | CQRS transaction query handler | Part06.2.3 CQRS Pattern | Query processing for transactions |
| Query Handlers | `backend/src/application/handlers/GetFraudScoreQueryHandler.ts` | CQRS fraud score query handler | Part06.2.3 CQRS Pattern | Query processing for fraud scores |
| **üèóÔ∏è BACKEND INFRASTRUCTURE** | | | | |
| Repositories | `backend/src/infrastructure/persistence/repositories/RedemptionRepository.ts` | PostgreSQL redemption repository | Part07.4.1 Redemption Table | Redemption data persistence |
| Repositories | `backend/src/infrastructure/persistence/repositories/TransactionRepository.ts` | PostgreSQL transaction repository | Part07.4.1 Redemption Table | Transaction data persistence |
| Repositories | `backend/src/infrastructure/persistence/repositories/FraudScoreRepository.ts` | PostgreSQL fraud score repository | Part07.4.2 Fraud_Score Table | Fraud data persistence |
| Repositories | `backend/src/infrastructure/persistence/repositories/DeviceFingerprintRepository.ts` | PostgreSQL device fingerprint repository | Part07.4.3 Device_Fingerprint Table | Device tracking persistence |
| Repositories | `backend/src/infrastructure/persistence/repositories/RedemptionAuditRepository.ts` | PostgreSQL audit repository | Part07.4.4 Audit_Log Table | Audit trail persistence |
| Repositories | `backend/src/infrastructure/persistence/repositories/BarcodeValidationRepository.ts` | PostgreSQL barcode validation repository | Part07.4.1 Redemption Table | Barcode verification persistence |
| Repositories | `backend/src/infrastructure/persistence/repositories/OfflineRedemptionRepository.ts` | PostgreSQL offline redemption repository | Part07.4.5 Offline_Redemption Table | Offline sync persistence |
| Models | `backend/src/infrastructure/persistence/models/RedemptionModel.ts` | Prisma redemption model | Part07.4.1 Redemption Table | Database schema mapping |
| Models | `backend/src/infrastructure/persistence/models/TransactionModel.ts` | Prisma transaction model | Part07.4.1 Redemption Table | Transaction schema mapping |
| Models | `backend/src/infrastructure/persistence/models/FraudScoreModel.ts` | Prisma fraud score model | Part07.4.2 Fraud_Score Table | Fraud schema mapping |
| Models | `backend/src/infrastructure/persistence/models/DeviceFingerprintModel.ts` | Prisma device fingerprint model | Part07.4.3 Device_Fingerprint Table | Device tracking schema |
| Models | `backend/src/infrastructure/persistence/models/RedemptionAuditModel.ts` | Prisma audit model | Part07.4.4 Audit_Log Table | Audit schema mapping |
| Models | `backend/src/infrastructure/persistence/models/BarcodeValidationModel.ts` | Prisma barcode validation model | Part07.4.1 Redemption Table | Barcode verification schema |
| Models | `backend/src/infrastructure/persistence/models/OfflineRedemptionModel.ts` | Prisma offline redemption model | Part07.4.5 Offline_Redemption Table | Offline sync schema |
| Migrations | `backend/src/infrastructure/persistence/migrations/001_create_redemptions.sql` | Redemption table creation | Part07.4.1 Redemption Table | Database schema setup |
| Migrations | `backend/src/infrastructure/persistence/migrations/002_create_fraud_scores.sql` | Fraud score table creation | Part07.4.2 Fraud_Score Table | Fraud detection schema |
| Migrations | `backend/src/infrastructure/persistence/migrations/003_create_device_fingerprints.sql` | Device fingerprint table creation | Part07.4.3 Device_Fingerprint Table | Device tracking schema |
| Migrations | `backend/src/infrastructure/persistence/migrations/004_create_audit_logs.sql` | Audit log table creation | Part07.4.4 Audit_Log Table | Audit trail schema |
| Migrations | `backend/src/infrastructure/persistence/migrations/005_create_offline_redemptions.sql` | Offline redemption table creation | Part07.4.5 Offline_Redemption Table | Offline sync schema |
| External Services | `backend/src/infrastructure/external-services/ScanditSDKService.ts` | Scandit SDK integration | Part09.2.1 Scandit SDK Integration | QR/barcode scanning capability |
| External Services | `backend/src/infrastructure/external-services/PaymentGatewayService.ts` | Payment gateway integration | Part09.3 Payment Integration | Payment processing service |
| External Services | `backend/src/infrastructure/external-services/FraudMLService.ts` | Machine learning fraud detection | Part04.3.5 Fraud Detection | ML model integration |
| External Services | `backend/src/infrastructure/external-services/POSSystemService.ts` | POS system integration | Part09.2 POS Integration | Point-of-sale connectivity |
| External Services | `backend/src/infrastructure/external-services/AuditLogService.ts` | External audit log service | Part05.6 Audit & Compliance | Compliance logging service |
| External Services | `backend/src/infrastructure/external-services/DeviceFingerprintService.ts` | Device fingerprinting service | Part04.3.5 Fraud Detection | Device identification service |
| External Services | `backend/src/infrastructure/external-services/GeoLocationService.ts` | Geolocation verification service | Part04.3.5 Fraud Detection | Location-based fraud detection |
| Config | `backend/src/infrastructure/config/redemption.config.ts` | Redemption service configuration | Part02.8 Technical Requirements | Service configuration management |
| Config | `backend/src/infrastructure/config/fraud.config.ts` | Fraud detection configuration | Part04.3.5 Fraud Detection | Fraud detection parameters |
| Config | `backend/src/infrastructure/config/payment.config.ts` | Payment gateway configuration | Part09.3 Payment Integration | Payment service configuration |
| Config | `backend/src/infrastructure/config/pos.config.ts` | POS integration configuration | Part09.2 POS Integration | POS system parameters |
| Config | `backend/src/infrastructure/config/audit.config.ts` | Audit configuration | Part05.6 Audit & Compliance | Audit service configuration |
| Config | `backend/src/infrastructure/config/ml.config.ts` | Machine learning configuration | Part04.3.5 Fraud Detection | ML model parameters |
| **üåê BACKEND PRESENTATION** | | | | |
| Controllers | `backend/src/presentation/controllers/RedemptionController.ts` | Redemption REST API controller | Part08.3.1 Redemption APIs | Redemption endpoint implementation |
| Controllers | `backend/src/presentation/controllers/TransactionController.ts` | Transaction REST API controller | Part08.3.1 Redemption APIs | Transaction endpoint implementation |
| Controllers | `backend/src/presentation/controllers/FraudController.ts` | Fraud detection REST API controller | Part08.3.2 Fraud Detection APIs | Fraud endpoint implementation |
| Controllers | `backend/src/presentation/controllers/BarcodeController.ts` | Barcode validation REST API controller | Part08.3.1 Redemption APIs | Barcode endpoint implementation |
| Controllers | `backend/src/presentation/controllers/AuditController.ts` | Audit REST API controller | Part08.3.1 Redemption APIs | Audit endpoint implementation |
| Controllers | `backend/src/presentation/controllers/POSController.ts` | POS integration REST API controller | Part08.3.1 Redemption APIs | POS endpoint implementation |
| Controllers | `backend/src/presentation/controllers/HealthController.ts` | Service health check controller | Part14.3 Monitoring Stack | Health monitoring endpoints |
| Middleware | `backend/src/presentation/middleware/AuthenticationMiddleware.ts` | JWT authentication middleware | Part05.3 Security Requirements | API security enforcement |
| Middleware | `backend/src/presentation/middleware/AuthorizationMiddleware.ts` | RBAC authorization middleware | Access_Control_Tree_Grok.md | Role-based access control |
| Middleware | `backend/src/presentation/middleware/ValidationMiddleware.ts` | Request validation middleware | Part05.7 Input Validation | Data validation enforcement |
| Middleware | `backend/src/presentation/middleware/RateLimitMiddleware.ts` | API rate limiting middleware | Part05.4 Rate Limiting | API protection |
| Middleware | `backend/src/presentation/middleware/LoggingMiddleware.ts` | Request logging middleware | Part14.3 Monitoring Stack | Request tracking |
| Middleware | `backend/src/presentation/middleware/FraudDetectionMiddleware.ts` | Real-time fraud detection middleware | Part04.3.5 Fraud Detection | Request-level fraud screening |
| Middleware | `backend/src/presentation/middleware/ErrorHandlingMiddleware.ts` | Centralized error handling | Part05.8 Error Handling | Error response standardization |
| **ü§ù SERVICE-SPECIFIC SHARED CODE** | | | | |
| Constants | `backend/src/shared/constants/redemption.constants.ts` | Redemption-specific constants | Part04.3.1 Barcode Redemption | Business rule constants |
| Constants | `backend/src/shared/constants/fraud.constants.ts` | Fraud detection constants | Part04.3.5 Fraud Detection | Fraud threshold constants |
| Constants | `backend/src/shared/constants/transaction.constants.ts` | Transaction constants | Part04.3.1 Barcode Redemption | Transaction type constants |
| Constants | `backend/src/shared/constants/api.constants.ts` | API-specific constants | Part08.3.1 Redemption APIs | API endpoint constants |
| Utils | `backend/src/shared/utils/barcode.utils.ts` | Barcode utility functions | Part04.3.1 Barcode Redemption | QR/barcode processing utilities |
| Utils | `backend/src/shared/utils/fraud.utils.ts` | Fraud detection utilities | Part04.3.5 Fraud Detection | Fraud calculation utilities |
| Utils | `backend/src/shared/utils/transaction.utils.ts` | Transaction utility functions | Part04.3.1 Barcode Redemption | Payment processing utilities |
| Utils | `backend/src/shared/utils/validation.utils.ts` | Validation utility functions | Part05.7 Input Validation | Data validation utilities |
| Utils | `backend/src/shared/utils/encryption.utils.ts` | Encryption utility functions | Part05.3 Security Requirements | Data encryption utilities |
| Utils | `backend/src/shared/utils/audit.utils.ts` | Audit utility functions | Part05.6 Audit & Compliance | Audit trail utilities |
| Utils | `backend/src/shared/utils/device.utils.ts` | Device utility functions | Part04.3.5 Fraud Detection | Device fingerprinting utilities |
| Exceptions | `backend/src/shared/exceptions/RedemptionException.ts` | Redemption-specific exceptions | Part05.8 Error Handling | Business logic errors |
| Exceptions | `backend/src/shared/exceptions/FraudException.ts` | Fraud detection exceptions | Part05.8 Error Handling | Fraud-related errors |
| Exceptions | `backend/src/shared/exceptions/TransactionException.ts` | Transaction exceptions | Part05.8 Error Handling | Payment processing errors |
| Exceptions | `backend/src/shared/exceptions/ValidationException.ts` | Validation exceptions | Part05.8 Error Handling | Data validation errors |
| Exceptions | `backend/src/shared/exceptions/POSException.ts` | POS integration exceptions | Part05.8 Error Handling | POS system errors |
| **üß™ BACKEND TESTING** | | | | |
| Unit Tests | `backend/tests/unit/domain/entities/Redemption.test.ts` | Redemption entity unit tests | Part15.1 Testing Strategy | Domain logic testing |
| Unit Tests | `backend/tests/unit/domain/entities/FraudScore.test.ts` | Fraud score entity unit tests | Part15.1 Testing Strategy | Fraud logic testing |
| Unit Tests | `backend/tests/unit/domain/entities/Transaction.test.ts` | Transaction entity unit tests | Part15.1 Testing Strategy | Transaction logic testing |
| Unit Tests | `backend/tests/unit/domain/entities/DeviceFingerprint.test.ts` | Device fingerprint entity unit tests | Part15.1 Testing Strategy | Device tracking logic testing |
| Unit Tests | `backend/tests/unit/domain/services/RedemptionDomainService.test.ts` | Redemption domain service tests | Part15.1 Testing Strategy | Business logic testing |
| Unit Tests | `backend/tests/unit/domain/services/FraudDetectionDomainService.test.ts` | Fraud detection domain service tests | Part15.1 Testing Strategy | Fraud algorithm testing |
| Unit Tests | `backend/tests/unit/application/use-cases/ProcessRedemptionUseCase.test.ts` | Process redemption use case tests | Part15.1 Testing Strategy | Use case logic testing |
| Unit Tests | `backend/tests/unit/application/use-cases/CalculateFraudScoreUseCase.test.ts` | Fraud score calculation tests | Part15.1 Testing Strategy | ML scoring testing |
| Unit Tests | `backend/tests/unit/infrastructure/external-services/ScanditSDKService.test.ts` | Scandit SDK service tests | Part15.1 Testing Strategy | External service testing |
| Unit Tests | `backend/tests/unit/infrastructure/external-services/PaymentGatewayService.test.ts` | Payment gateway service tests | Part15.1 Testing Strategy | Payment service testing |
| Integration Tests | `backend/tests/integration/redemption/redemption-flow.test.ts` | End-to-end redemption flow tests | Part15.1 Testing Strategy | Full redemption workflow testing |
| Integration Tests | `backend/tests/integration/fraud/fraud-detection.test.ts` | Fraud detection integration tests | Part15.1 Testing Strategy | ML fraud detection testing |
| Integration Tests | `backend/tests/integration/transaction/payment-processing.test.ts` | Payment processing integration tests | Part15.1 Testing Strategy | Payment workflow testing |
| Integration Tests | `backend/tests/integration/pos/pos-sync.test.ts` | POS synchronization tests | Part15.1 Testing Strategy | POS integration testing |
| Integration Tests | `backend/tests/integration/audit/audit-trail.test.ts` | Audit trail integration tests | Part15.1 Testing Strategy | Compliance audit testing |
| Integration Tests | `backend/tests/integration/database/redemption-repository.test.ts` | Redemption repository tests | Part15.1 Testing Strategy | Database layer testing |
| Integration Tests | `backend/tests/integration/database/fraud-repository.test.ts` | Fraud repository tests | Part15.1 Testing Strategy | Fraud data access testing |
| E2E Tests | `backend/tests/e2e/redemption/complete-redemption-flow.test.ts` | Complete redemption flow E2E tests | Part15.1 Testing Strategy | End-to-end system testing |
| E2E Tests | `backend/tests/e2e/fraud/fraud-prevention-flow.test.ts` | Fraud prevention flow E2E tests | Part15.1 Testing Strategy | Fraud detection system testing |
| E2E Tests | `backend/tests/e2e/pos/offline-pos-sync.test.ts` | Offline POS sync E2E tests | Part15.1 Testing Strategy | Offline capability testing |
| E2E Tests | `backend/tests/e2e/api/redemption-api.test.ts` | Redemption API E2E tests | Part15.1 Testing Strategy | API integration testing |
| E2E Tests | `backend/tests/e2e/api/fraud-api.test.ts` | Fraud API E2E tests | Part15.1 Testing Strategy | Fraud API testing |
| **üê≥ CONTAINERIZATION & DEPLOYMENT** | | | | |
| Docker | `backend/Dockerfile` | Redemption service containerization | Part14.1 Containerization | Service deployment container |
| Docker | `backend/.dockerignore` | Docker ignore file | Part14.1 Containerization | Build optimization |
| Docker | `backend/docker-compose.yml` | Local development environment | Part14.1 Containerization | Local testing setup |
| Kubernetes | `k8s/redemption-deployment.yaml` | Kubernetes deployment manifest | Part14.2 Kubernetes Deployment | Production deployment |
| Kubernetes | `k8s/redemption-service.yaml` | Kubernetes service manifest | Part14.2 Kubernetes Deployment | Service discovery |
| Kubernetes | `k8s/redemption-ingress.yaml` | Kubernetes ingress manifest | Part14.2 Kubernetes Deployment | Traffic routing |
| Kubernetes | `k8s/redemption-configmap.yaml` | Kubernetes config map | Part14.2 Kubernetes Deployment | Configuration management |
| Kubernetes | `k8s/redemption-secrets.yaml` | Kubernetes secrets manifest | Part14.2 Kubernetes Deployment | Sensitive data management |
| **üìä MONITORING & OBSERVABILITY** | | | | |
| Monitoring | `monitoring/prometheus/redemption-metrics.yaml` | Prometheus metrics configuration | Part14.3 Monitoring Stack | Service metrics collection |
| Monitoring | `monitoring/grafana/dashboards/redemption-dashboard.json` | Grafana dashboard for redemption service | Part14.3 Monitoring Stack | Metrics visualization |
| Monitoring | `monitoring/grafana/dashboards/fraud-detection-dashboard.json` | Grafana dashboard for fraud detection | Part14.3 Monitoring Stack | Fraud metrics visualization |
| Monitoring | `monitoring/alerts/redemption-alerts.yaml` | Alert rules for redemption service | Part14.3 Monitoring Stack | Service health alerts |
| Monitoring | `monitoring/alerts/fraud-alerts.yaml` | Alert rules for fraud detection | Part14.3 Monitoring Stack | Fraud detection alerts |
| **üöÄ CI/CD & AUTOMATION** | | | | |
| CI/CD | `.github/workflows/redemption-ci.yml` | Continuous integration pipeline | Part15.2 CI/CD Pipelines | Automated testing and building |
| CI/CD | `.github/workflows/redemption-cd.yml` | Continuous deployment pipeline | Part15.2 CI/CD Pipelines | Automated deployment |
| Scripts | `scripts/setup-redemption-service.sh` | Service setup automation | Part15.2 CI/CD Pipelines | Local environment setup |
| Scripts | `scripts/deploy-redemption-service.sh` | Deployment automation | Part15.2 CI/CD Pipelines | Production deployment |
| Scripts | `scripts/migrate-database.sh` | Database migration automation | Part15.2 CI/CD Pipelines | Schema updates |
| Scripts | `scripts/backup-redemption-data.sh` | Data backup automation | Part15.2 CI/CD Pipelines | Data protection |
| Scripts | `scripts/fraud-model-update.sh` | ML model update automation | Part04.3.5 Fraud Detection | Model deployment |
| **üìö DOCUMENTATION** | | | | |
| API Docs | `docs/api/redemption-api.md` | Redemption API documentation | Part08.3.1 Redemption APIs | API specification |
| API Docs | `docs/api/fraud-detection-api.md` | Fraud detection API documentation | Part08.3.2 Fraud Detection APIs | Fraud API specification |
| API Docs | `docs/api/transaction-api.md` | Transaction API documentation | Part08.3.1 Redemption APIs | Transaction API specification |
| API Docs | `docs/api/barcode-validation-api.md` | Barcode validation API documentation | Part08.3.1 Redemption APIs | Barcode API specification |
| API Docs | `docs/api/pos-integration-api.md` | POS integration API documentation | Part08.3.1 Redemption APIs | POS API specification |
| Architecture | `docs/architecture/redemption-architecture.md` | Redemption service architecture guide | Part06.2.1 Layered Architecture | Architecture documentation |
| Architecture | `docs/architecture/fraud-detection-architecture.md` | Fraud detection architecture guide | Part04.3.5 Fraud Detection | Fraud system documentation |
| Security | `docs/security/redemption-security.md` | Security implementation guide | Part05.3 Security Requirements | Security documentation |
| Operations | `docs/operations/redemption-runbook.md` | Operational procedures guide | Part14.3 Monitoring Stack | Operations documentation |
| Operations | `docs/operations/fraud-model-management.md` | ML model management guide | Part04.3.5 Fraud Detection | Model operations documentation |

---

## üìÅ **C·∫§U TR√öC TH∆Ø M·ª§C HO√ÄN CH·ªàNH**

```bash
redemption-transaction-service/
‚îú‚îÄ‚îÄ üìÇ backend/                                 # Redemption & Transaction Service
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ domain/                          # Domain Layer
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ entities/                    # Business Entities
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Redemption.ts                # Core redemption entity
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Transaction.ts               # Transaction entity
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FraudScore.ts                # Fraud detection entity
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DeviceFingerprint.ts         # Device fingerprinting
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RedemptionAudit.ts           # Audit log entity
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BarcodeValidation.ts         # Barcode validation entity
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ OfflineRedemption.ts         # Offline redemption entity
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ POSIntegration.ts            # POS integration entity
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ value-objects/               # Value Objects
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BarcodeValue.ts              # Barcode value object
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TransactionAmount.ts         # Transaction amount
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FraudRiskLevel.ts            # Fraud risk assessment
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RedemptionStatus.ts          # Redemption status
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DeviceIdentifier.ts          # Device identification
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ repositories/                # Repository Interfaces
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IRedemptionRepository.ts     # Redemption repository interface
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ITransactionRepository.ts    # Transaction repository interface
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IFraudScoreRepository.ts     # Fraud score repository interface
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IDeviceFingerprintRepository.ts # Device repository interface
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IRedemptionAuditRepository.ts # Audit repository interface
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IBarcodeValidationRepository.ts # Barcode repository interface
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ IOfflineRedemptionRepository.ts # Offline repository interface
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ services/                    # Domain Services
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ RedemptionDomainService.ts   # Redemption business logic
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ FraudDetectionDomainService.ts # Fraud detection logic
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ BarcodeValidationDomainService.ts # Barcode validation
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ DeviceFingerprintDomainService.ts # Device fingerprinting
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ TransactionDomainService.ts  # Transaction processing
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ application/                     # Application Layer
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ use-cases/                   # Use Cases
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ redemption/              # Redemption Use Cases
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProcessRedemptionUseCase.ts # Main redemption workflow
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ValidateBarcodeUseCase.ts # Barcode validation
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProcessOfflineRedemptionUseCase.ts # Offline processing
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GetRedemptionStatusUseCase.ts # Status tracking
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CancelRedemptionUseCase.ts # Cancellation logic
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ transaction/             # Transaction Use Cases
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CreateTransactionUseCase.ts # Transaction creation
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProcessPaymentUseCase.ts # Payment processing
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RefundTransactionUseCase.ts # Refund logic
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ GetTransactionHistoryUseCase.ts # History retrieval
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ fraud/                   # Fraud Detection Use Cases
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CalculateFraudScoreUseCase.ts # Fraud scoring
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProcessFraudAlertUseCase.ts # Alert processing
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CreateDeviceFingerprintUseCase.ts # Device fingerprinting
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CheckDeviceRiskUseCase.ts # Risk assessment
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UpdateFraudRulesUseCase.ts # Rules management
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ audit/                   # Audit Use Cases
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CreateAuditLogUseCase.ts # Audit log creation
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ GetAuditTrailUseCase.ts  # Audit trail retrieval
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ pos/                     # POS Integration Use Cases
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ SyncPOSDataUseCase.ts    # POS data sync
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ProcessOfflinePOSUseCase.ts # Offline POS processing
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ dto/                         # Data Transfer Objects
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RedemptionDTO.ts             # Redemption DTOs
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TransactionDTO.ts            # Transaction DTOs
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FraudDTO.ts                  # Fraud DTOs
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BarcodeDTO.ts                # Barcode DTOs
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuditDTO.ts                  # Audit DTOs
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ POSDTO.ts                    # POS DTOs
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ handlers/                    # CQRS Handlers
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ProcessRedemptionHandler.ts  # Redemption command handler
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ProcessTransactionHandler.ts # Transaction command handler
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ FraudDetectionHandler.ts     # Fraud command handler
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ GetRedemptionQueryHandler.ts # Redemption query handler
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ GetTransactionQueryHandler.ts # Transaction query handler
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ GetFraudScoreQueryHandler.ts # Fraud query handler
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ infrastructure/                  # Infrastructure Layer
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ persistence/                 # Data Persistence
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ repositories/            # Repository Implementations
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RedemptionRepository.ts  # Redemption data access
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TransactionRepository.ts # Transaction data access
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FraudScoreRepository.ts  # Fraud data access
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DeviceFingerprintRepository.ts # Device data access
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RedemptionAuditRepository.ts # Audit data access
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BarcodeValidationRepository.ts # Barcode data access
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ OfflineRedemptionRepository.ts # Offline data access
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ models/                  # Database Models
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RedemptionModel.ts       # Redemption model
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TransactionModel.ts      # Transaction model
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FraudScoreModel.ts       # Fraud score model
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DeviceFingerprintModel.ts # Device model
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RedemptionAuditModel.ts  # Audit model
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BarcodeValidationModel.ts # Barcode model
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ OfflineRedemptionModel.ts # Offline model
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ migrations/              # Database Migrations
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ 001_create_redemptions.sql # Redemption schema
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ 002_create_fraud_scores.sql # Fraud schema
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ 003_create_device_fingerprints.sql # Device schema
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ 004_create_audit_logs.sql # Audit schema
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ 005_create_offline_redemptions.sql # Offline schema
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ external-services/           # External Service Adapters
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ScanditSDKService.ts         # Scandit SDK integration
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PaymentGatewayService.ts     # Payment processing
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FraudMLService.ts            # ML fraud detection
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ POSSystemService.ts          # POS integration
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuditLogService.ts           # Audit logging
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DeviceFingerprintService.ts  # Device fingerprinting
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ GeoLocationService.ts        # Geolocation verification
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ config/                      # Configuration
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ redemption.config.ts         # Redemption config
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ fraud.config.ts              # Fraud config
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ payment.config.ts            # Payment config
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ pos.config.ts                # POS config
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ audit.config.ts              # Audit config
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ml.config.ts                 # ML config
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ presentation/                    # Presentation Layer
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ controllers/                 # REST Controllers
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RedemptionController.ts      # Redemption endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TransactionController.ts     # Transaction endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FraudController.ts           # Fraud endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BarcodeController.ts         # Barcode endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuditController.ts           # Audit endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ POSController.ts             # POS endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ HealthController.ts          # Health check
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ middleware/                  # Middleware
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ AuthenticationMiddleware.ts  # JWT authentication
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ AuthorizationMiddleware.ts   # RBAC authorization
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ValidationMiddleware.ts      # Request validation
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ RateLimitMiddleware.ts       # Rate limiting
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ LoggingMiddleware.ts         # Request logging
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ FraudDetectionMiddleware.ts  # Real-time fraud detection
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ErrorHandlingMiddleware.ts   # Error handling
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ shared/                          # Service-Specific Shared Code
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ üìÇ constants/                   # Constants
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ redemption.constants.ts      # Redemption constants
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ fraud.constants.ts           # Fraud constants
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ transaction.constants.ts     # Transaction constants
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ api.constants.ts             # API constants
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ üìÇ utils/                       # Utilities
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ barcode.utils.ts             # Barcode utilities
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ fraud.utils.ts               # Fraud utilities
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ transaction.utils.ts         # Transaction utilities
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ validation.utils.ts          # Validation utilities
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ encryption.utils.ts          # Encryption utilities
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ audit.utils.ts               # Audit utilities
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ device.utils.ts              # Device utilities
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ üìÇ exceptions/                  # Custom Exceptions
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ RedemptionException.ts       # Redemption errors
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ FraudException.ts            # Fraud errors
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ TransactionException.ts      # Transaction errors
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ ValidationException.ts       # Validation errors
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ POSException.ts              # POS errors
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ tests/                               # Testing
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ unit/                            # Unit Tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ domain/                      # Domain Tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ entities/                # Entity Tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Redemption.test.ts       # Redemption entity tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FraudScore.test.ts       # Fraud entity tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Transaction.test.ts      # Transaction entity tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DeviceFingerprint.test.ts # Device entity tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ services/                # Service Tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ RedemptionDomainService.test.ts # Redemption service tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ FraudDetectionDomainService.test.ts # Fraud service tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ application/                 # Application Tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ use-cases/               # Use Case Tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ProcessRedemptionUseCase.test.ts # Redemption tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ CalculateFraudScoreUseCase.test.ts # Fraud tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ infrastructure/              # Infrastructure Tests
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ üìÇ external-services/       # External Service Tests
‚îÇ   ‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ ScanditSDKService.test.ts # Scandit tests
‚îÇ   ‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ PaymentGatewayService.test.ts # Payment tests
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ integration/                     # Integration Tests
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ redemption/                  # Redemption Integration
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ redemption-flow.test.ts      # End-to-end redemption
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ fraud/                       # Fraud Integration
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ fraud-detection.test.ts      # Fraud detection flow
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ transaction/                 # Transaction Integration
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ payment-processing.test.ts   # Payment flow
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ pos/                         # POS Integration
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pos-sync.test.ts             # POS sync flow
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ audit/                       # Audit Integration
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ audit-trail.test.ts          # Audit flow
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ database/                    # Database Integration
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ redemption-repository.test.ts # Redemption DB tests
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ fraud-repository.test.ts     # Fraud DB tests
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ e2e/                             # E2E Tests
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ üìÇ redemption/                  # Redemption E2E
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ complete-redemption-flow.test.ts # Full redemption
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ üìÇ fraud/                       # Fraud E2E
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ fraud-prevention-flow.test.ts # Fraud prevention
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ üìÇ pos/                         # POS E2E
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ offline-pos-sync.test.ts     # Offline POS
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ üìÇ api/                         # API E2E
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ redemption-api.test.ts       # Redemption API
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ fraud-api.test.ts            # Fraud API
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ package.json                            # Node.js dependencies
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json                           # TypeScript configuration
‚îÇ   ‚îú‚îÄ‚îÄ eslint.config.js                        # ESLint configuration
‚îÇ   ‚îú‚îÄ‚îÄ jest.config.js                          # Jest testing configuration
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                              # Container definition
‚îÇ   ‚îú‚îÄ‚îÄ .dockerignore                           # Docker ignore rules
‚îÇ   ‚îî‚îÄ‚îÄ docker-compose.yml                      # Local development environment
‚îÇ
‚îú‚îÄ‚îÄ üìÇ k8s/                                     # Kubernetes Manifests
‚îÇ   ‚îú‚îÄ‚îÄ redemption-deployment.yaml              # Deployment configuration
‚îÇ   ‚îú‚îÄ‚îÄ redemption-service.yaml                 # Service configuration
‚îÇ   ‚îú‚îÄ‚îÄ redemption-ingress.yaml                 # Ingress configuration
‚îÇ   ‚îú‚îÄ‚îÄ redemption-configmap.yaml               # Configuration map
‚îÇ   ‚îî‚îÄ‚îÄ redemption-secrets.yaml                 # Secrets configuration
‚îÇ
‚îú‚îÄ‚îÄ üìÇ monitoring/                              # Monitoring & Observability
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ prometheus/                          # Prometheus Configuration
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ redemption-metrics.yaml             # Metrics configuration
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ grafana/                             # Grafana Dashboards
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ dashboards/                      # Dashboard Definitions
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ redemption-dashboard.json       # Redemption metrics
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ fraud-detection-dashboard.json  # Fraud metrics
‚îÇ   ‚îî‚îÄ‚îÄ üìÇ alerts/                              # Alert Rules
‚îÇ       ‚îú‚îÄ‚îÄ redemption-alerts.yaml              # Redemption alerts
‚îÇ       ‚îî‚îÄ‚îÄ fraud-alerts.yaml                   # Fraud alerts
‚îÇ
‚îú‚îÄ‚îÄ üìÇ .github/                                 # CI/CD Pipelines
‚îÇ   ‚îî‚îÄ‚îÄ üìÇ workflows/                           # GitHub Actions
‚îÇ       ‚îú‚îÄ‚îÄ redemption-ci.yml                   # Continuous integration
‚îÇ       ‚îî‚îÄ‚îÄ redemption-cd.yml                   # Continuous deployment
‚îÇ
‚îú‚îÄ‚îÄ üìÇ scripts/                                 # Automation Scripts
‚îÇ   ‚îú‚îÄ‚îÄ setup-redemption-service.sh             # Service setup
‚îÇ   ‚îú‚îÄ‚îÄ deploy-redemption-service.sh            # Deployment script
‚îÇ   ‚îú‚îÄ‚îÄ migrate-database.sh                     # Database migration
‚îÇ   ‚îú‚îÄ‚îÄ backup-redemption-data.sh               # Data backup
‚îÇ   ‚îî‚îÄ‚îÄ fraud-model-update.sh                   # ML model update
‚îÇ
‚îú‚îÄ‚îÄ üìÇ docs/                                    # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ api/                                 # API Documentation
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ redemption-api.md                   # Redemption API docs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fraud-detection-api.md              # Fraud API docs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ transaction-api.md                  # Transaction API docs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ barcode-validation-api.md           # Barcode API docs
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pos-integration-api.md              # POS API docs
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ architecture/                        # Architecture Documentation
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ redemption-architecture.md          # Architecture guide
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ fraud-detection-architecture.md     # Fraud architecture
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ security/                            # Security Documentation
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ redemption-security.md              # Security guide
‚îÇ   ‚îî‚îÄ‚îÄ üìÇ operations/                          # Operations Documentation
‚îÇ       ‚îú‚îÄ‚îÄ redemption-runbook.md               # Operations guide
‚îÇ       ‚îî‚îÄ‚îÄ fraud-model-management.md           # ML model guide
‚îÇ
‚îú‚îÄ‚îÄ README.md                                   # Project overview
‚îú‚îÄ‚îÄ CHANGELOG.md                                # Version history
‚îú‚îÄ‚îÄ LICENSE                                     # License information
‚îî‚îÄ‚îÄ .env.example                                # Environment variables template
```

---

## üîß **IMPLEMENTATION CHECKLIST**

### **Phase 1: PROJECT SETUP & SHARED PACKAGES** ‚öôÔ∏è

#### **1.1 Kh·ªüi t·∫°o d·ª± √°n repository**
- [ ] **T·∫°o redemption-transaction-service repository**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part06.2.1 Layered Architecture + EMSA-v1.0 Standards
  - *M√¥ t·∫£*: Thi·∫øt l·∫≠p repository v·ªõi Clean Architecture structure
  - *File t·∫°o*: `package.json`, `README.md`, `.gitignore`, to√†n b·ªô folder structure
  - *√ù nghƒ©a*: Single repository cho complete Redemption service, EMSA-v1.0 compliant

#### **1.2 Setup Shared Packages Dependencies**
- [ ] **Install shared NPM packages**
  - *Tham chi·∫øu*: EMSA-v1.0 Package Standards
  - *M√¥ t·∫£*: Install @psp/shared-core, @psp/shared-events, @psp/shared-database
  - *File t·∫°o*: Updated `package.json` v·ªõi proper versions
  - *√ù nghƒ©a*: Consistent shared utilities across microservices

#### **1.3 Configuration Files Setup**
- [ ] **Setup project configuration files**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part02.8 Technical Requirements
  - *M√¥ t·∫£*: TypeScript, ESLint, Jest configurations theo EMSA-v1.0
  - *File t·∫°o*: `tsconfig.json`, `eslint.config.js`, `jest.config.js`
  - *√ù nghƒ©a*: Standardized development environment

#### **1.4 Database Setup**
- [ ] **Thi·∫øt l·∫≠p PostgreSQL cho redemption data**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part07.4 Redemption Database Design
  - *M√¥ t·∫£*: PostgreSQL 15+ v·ªõi redemption, fraud, transaction schemas
  - *File t·∫°o*: `backend/prisma/schema.prisma`, database connection config
  - *√ù nghƒ©a*: Robust data persistence cho redemption workflows

### **Phase 2: DOMAIN LAYER IMPLEMENTATION** üóÉÔ∏è

#### **2.1 Core Entities Implementation**
- [ ] **Implement Redemption Entity**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.1 Barcode Redemption (FR-007)
  - *M√¥ t·∫£*: Redemption entity v·ªõi business rules, status transitions, validation
  - *File t·∫°o*: `backend/src/domain/entities/Redemption.ts`
  - *√ù nghƒ©a*: Core redemption business logic encapsulation

- [ ] **Implement FraudScore Entity**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.5 Fraud Detection (FR-011)
  - *M√¥ t·∫£*: Fraud detection entity v·ªõi ML scoring, risk assessment
  - *File t·∫°o*: `backend/src/domain/entities/FraudScore.ts`
  - *√ù nghƒ©a*: ML-based fraud prevention logic

- [ ] **Implement Transaction Entity**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.1 Barcode Redemption
  - *M√¥ t·∫£*: Transaction entity v·ªõi payment processing, refund handling
  - *File t·∫°o*: `backend/src/domain/entities/Transaction.ts`
  - *√ù nghƒ©a*: Financial transaction management

- [ ] **Implement DeviceFingerprint Entity**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.5 Fraud Detection
  - *M√¥ t·∫£*: Device fingerprinting entity cho fraud prevention
  - *File t·∫°o*: `backend/src/domain/entities/DeviceFingerprint.ts`
  - *√ù nghƒ©a*: Device-based security v√† fraud detection

#### **2.2 Value Objects Implementation**
- [ ] **Implement BarcodeValue Value Object**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.1 Barcode Redemption
  - *M√¥ t·∫£*: Barcode value object v·ªõi format validation, QR verification
  - *File t·∫°o*: `backend/src/domain/value-objects/BarcodeValue.ts`
  - *√ù nghƒ©a*: Type-safe barcode handling v·ªõi validation

- [ ] **Implement FraudRiskLevel Value Object**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.5 Fraud Detection
  - *M√¥ t·∫£*: Fraud risk assessment v·ªõi categorization (Low/Medium/High)
  - *File t·∫°o*: `backend/src/domain/value-objects/FraudRiskLevel.ts`
  - *√ù nghƒ©a*: Standardized risk assessment levels

- [ ] **Implement RedemptionStatus Value Object**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.1 Barcode Redemption
  - *M√¥ t·∫£*: Redemption status management v·ªõi state transition rules
  - *File t·∫°o*: `backend/src/domain/value-objects/RedemptionStatus.ts`
  - *√ù nghƒ©a*: Controlled redemption state transitions

#### **2.3 Domain Services Implementation**
- [ ] **Implement RedemptionDomainService**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.1 Barcode Redemption
  - *M√¥ t·∫£*: Complex redemption business logic, workflow orchestration
  - *File t·∫°o*: `backend/src/domain/services/RedemptionDomainService.ts`
  - *√ù nghƒ©a*: Centralized redemption business rules

- [ ] **Implement FraudDetectionDomainService**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.5 Fraud Detection
  - *M√¥ t·∫£*: ML fraud scoring algorithms, risk calculation
  - *File t·∫°o*: `backend/src/domain/services/FraudDetectionDomainService.ts`
  - *√ù nghƒ©a*: Advanced fraud detection capabilities

### **Phase 3: APPLICATION LAYER IMPLEMENTATION** üìÑ

#### **3.1 Use Cases Implementation**
- [ ] **Implement Redemption Use Cases**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.1 Barcode Redemption (FR-007)
  - *M√¥ t·∫£*: Main redemption workflows, validation, offline processing
  - *File t·∫°o*: `ProcessRedemptionUseCase.ts`, `ValidateBarcodeUseCase.ts`, `ProcessOfflineRedemptionUseCase.ts`, `GetRedemptionStatusUseCase.ts`, `CancelRedemptionUseCase.ts`
  - *√ù nghƒ©a*: Complete redemption workflow support

- [ ] **Implement Fraud Detection Use Cases**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.5 Fraud Detection (FR-011)
  - *M√¥ t·∫£*: Fraud scoring, alert processing, device fingerprinting
  - *File t·∫°o*: `CalculateFraudScoreUseCase.ts`, `ProcessFraudAlertUseCase.ts`, `CreateDeviceFingerprintUseCase.ts`, `CheckDeviceRiskUseCase.ts`, `UpdateFraudRulesUseCase.ts`
  - *√ù nghƒ©a*: Comprehensive fraud prevention system

- [ ] **Implement Transaction Use Cases**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.1 Barcode Redemption
  - *M√¥ t·∫£*: Payment processing, refunds, transaction history
  - *File t·∫°o*: `CreateTransactionUseCase.ts`, `ProcessPaymentUseCase.ts`, `RefundTransactionUseCase.ts`, `GetTransactionHistoryUseCase.ts`
  - *√ù nghƒ©a*: Complete transaction management

#### **3.2 CQRS Handlers Implementation**
- [ ] **Implement Command Handlers**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part06.2.3 CQRS Pattern
  - *M√¥ t·∫£*: CQRS command handlers cho redemption, transaction, fraud
  - *File t·∫°o*: `ProcessRedemptionHandler.ts`, `ProcessTransactionHandler.ts`, `FraudDetectionHandler.ts`
  - *√ù nghƒ©a*: Scalable command processing architecture

- [ ] **Implement Query Handlers**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part06.2.3 CQRS Pattern
  - *M√¥ t·∫£*: CQRS query handlers cho data retrieval
  - *File t·∫°o*: `GetRedemptionQueryHandler.ts`, `GetTransactionQueryHandler.ts`, `GetFraudScoreQueryHandler.ts`
  - *√ù nghƒ©a*: Optimized read operations

### **Phase 4: INFRASTRUCTURE LAYER IMPLEMENTATION** üèóÔ∏è

#### **4.1 Repository Implementations**
- [ ] **Implement PostgreSQL Repositories**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part07.4.1 Redemption Table + Part07.4.2 Fraud_Score Table
  - *M√¥ t·∫£*: Concrete repository implementations v·ªõi Prisma ORM
  - *File t·∫°o*: `RedemptionRepository.ts`, `TransactionRepository.ts`, `FraudScoreRepository.ts`, `DeviceFingerprintRepository.ts`, `RedemptionAuditRepository.ts`
  - *√ù nghƒ©a*: Data access layer cho redemption operations

#### **4.2 External Services Implementation**
- [ ] **Implement Scandit SDK Service**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part09.2.1 Scandit SDK Integration
  - *M√¥ t·∫£*: QR/barcode scanning capability integration
  - *File t·∫°o*: `backend/src/infrastructure/external-services/ScanditSDKService.ts`
  - *√ù nghƒ©a*: Professional barcode scanning functionality

- [ ] **Implement Payment Gateway Service**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part09.3 Payment Integration
  - *M√¥ t·∫£*: Payment processing integration v·ªõi external providers
  - *File t·∫°o*: `backend/src/infrastructure/external-services/PaymentGatewayService.ts`
  - *√ù nghƒ©a*: Secure payment processing capability

- [ ] **Implement ML Fraud Detection Service**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.5 Fraud Detection
  - *M√¥ t·∫£*: Machine learning fraud detection integration
  - *File t·∫°o*: `backend/src/infrastructure/external-services/FraudMLService.ts`
  - *√ù nghƒ©a*: Advanced AI-powered fraud prevention

- [ ] **Implement POS System Service**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part09.2 POS Integration
  - *M√¥ t·∫£*: Point-of-sale system integration cho offline redemption
  - *File t·∫°o*: `backend/src/infrastructure/external-services/POSSystemService.ts`
  - *√ù nghƒ©a*: Offline redemption capability

#### **4.3 Configuration Implementation**
- [ ] **Implement Service Configurations**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part02.8 Technical Requirements
  - *M√¥ t·∫£*: Service-specific configuration management
  - *File t·∫°o*: `redemption.config.ts`, `fraud.config.ts`, `payment.config.ts`, `pos.config.ts`, `audit.config.ts`, `ml.config.ts`
  - *√ù nghƒ©a*: Centralized configuration cho service components

### **Phase 5: PRESENTATION LAYER IMPLEMENTATION** üåê

#### **5.1 REST API Controllers**
- [ ] **Implement API Controllers**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part08.3.1 Redemption APIs + Part08.3.2 Fraud Detection APIs
  - *M√¥ t·∫£*: REST API controllers cho redemption, fraud, transaction management
  - *File t·∫°o*: `RedemptionController.ts`, `TransactionController.ts`, `FraudController.ts`, `BarcodeController.ts`, `AuditController.ts`, `POSController.ts`, `HealthController.ts`
  - *√ù nghƒ©a*: Complete API endpoints supporting full functionality

#### **5.2 Security Middleware**
- [ ] **Implement Security Middleware**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part05.3 Security Requirements + Access_Control_Tree_Grok.md
  - *M√¥ t·∫£*: Authentication, authorization, validation, rate limiting middleware
  - *File t·∫°o*: `AuthenticationMiddleware.ts`, `AuthorizationMiddleware.ts`, `ValidationMiddleware.ts`, `RateLimitMiddleware.ts`, `LoggingMiddleware.ts`, `FraudDetectionMiddleware.ts`, `ErrorHandlingMiddleware.ts`
  - *√ù nghƒ©a*: Comprehensive security enforcement cho API access

#### **5.3 Service-Specific Shared Code Implementation**
- [ ] **Implement Service-Specific Constants v√† Utils**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part04.3.1 Barcode Redemption + Part04.3.5 Fraud Detection
  - *M√¥ t·∫£*: Redemption, fraud, transaction constants v√† utilities
  - *File t·∫°o*: Constants files, utility functions, custom exceptions
  - *√ù nghƒ©a*: Reusable service-specific code components

### **Phase 6: TESTING IMPLEMENTATION** üß™

#### **6.1 Unit Testing**
- [ ] **Implement Domain Unit Tests**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part15.1 Testing Strategy
  - *M√¥ t·∫£*: Entity, value object, domain service unit tests
  - *File t·∫°o*: 10+ unit test files cho domain layer
  - *√ù nghƒ©a*: Ensure business logic correctness

- [ ] **Implement Application Unit Tests**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part15.1 Testing Strategy
  - *M√¥ t·∫£*: Use case, handler unit tests
  - *File t·∫°o*: 15+ unit test files cho application layer
  - *√ù nghƒ©a*: Validate application workflows

#### **6.2 Integration Testing**
- [ ] **Implement Integration Tests**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part15.1 Testing Strategy
  - *M√¥ t·∫£*: Database, external service, API integration tests
  - *File t·∫°o*: 7+ integration test files
  - *√ù nghƒ©a*: Verify component interactions

#### **6.3 End-to-End Testing**
- [ ] **Implement E2E Tests**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part15.1 Testing Strategy
  - *M√¥ t·∫£*: Complete workflow, API, system E2E tests
  - *File t·∫°o*: 5+ E2E test files
  - *√ù nghƒ©a*: Validate complete system functionality

### **Phase 7: DEVOPS & DEPLOYMENT** üöÄ

#### **7.1 Containerization**
- [ ] **Setup Docker Configuration**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part14.1 Containerization
  - *M√¥ t·∫£*: Docker containerization cho service deployment
  - *File t·∫°o*: `Dockerfile`, `.dockerignore`, `docker-compose.yml`
  - *√ù nghƒ©a*: Consistent deployment environment

#### **7.2 Kubernetes Deployment**
- [ ] **Setup Kubernetes Manifests**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part14.2 Kubernetes Deployment
  - *M√¥ t·∫£*: Production-ready Kubernetes deployment configuration
  - *File t·∫°o*: `redemption-deployment.yaml`, `redemption-service.yaml`, `redemption-ingress.yaml`, `redemption-configmap.yaml`, `redemption-secrets.yaml`
  - *√ù nghƒ©a*: Scalable production deployment

#### **7.3 CI/CD Pipeline**
- [ ] **Setup CI/CD Automation**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part15.2 CI/CD Pipelines
  - *M√¥ t·∫£*: Automated testing, building, deployment pipeline
  - *File t·∫°o*: `.github/workflows/redemption-ci.yml`, `redemption-cd.yml`
  - *√ù nghƒ©a*: Automated quality assurance v√† deployment

#### **7.4 Monitoring & Observability**
- [ ] **Setup Monitoring Stack**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part14.3 Monitoring Stack
  - *M√¥ t·∫£*: Prometheus metrics, Grafana dashboards, alerting
  - *File t·∫°o*: `monitoring/prometheus/redemption-metrics.yaml`, `monitoring/grafana/dashboards/redemption-dashboard.json`, `monitoring/grafana/dashboards/fraud-detection-dashboard.json`
  - *√ù nghƒ©a*: Production monitoring v√† alerting

### **Phase 8: DOCUMENTATION & AUTOMATION** üìö

#### **8.1 API Documentation**
- [ ] **Create API Documentation**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part08.3.1 Redemption APIs + Part08.3.2 Fraud Detection APIs
  - *M√¥ t·∫£*: Complete API documentation v·ªõi examples
  - *File t·∫°o*: `docs/api/redemption-api.md`, `fraud-detection-api.md`, `transaction-api.md`, `barcode-validation-api.md`, `pos-integration-api.md`
  - *√ù nghƒ©a*: Developer onboarding v√† service integration

#### **8.2 Architecture Documentation**
- [ ] **Create Architecture Guides**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part06.2.1 Layered Architecture + EMSA-v1.0
  - *M√¥ t·∫£*: Clean Architecture implementation guide, fraud detection architecture
  - *File t·∫°o*: `docs/architecture/redemption-architecture.md`, `docs/architecture/fraud-detection-architecture.md`
  - *√ù nghƒ©a*: Architectural understanding v√† maintenance

#### **8.3 Security Documentation**
- [ ] **Create Security Documentation**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part05.3 Security Requirements
  - *M√¥ t·∫£*: Security implementation guide, fraud prevention strategies
  - *File t·∫°o*: `docs/security/redemption-security.md`
  - *√ù nghƒ©a*: Security compliance v√† best practices

#### **8.4 Operations Documentation**
- [ ] **Create Operations Guides**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part14.3 Monitoring Stack
  - *M√¥ t·∫£*: Operational procedures, ML model management, runbooks
  - *File t·∫°o*: `docs/operations/redemption-runbook.md`, `docs/operations/fraud-model-management.md`
  - *√ù nghƒ©a*: Operational excellence v√† incident response

#### **8.5 Automation Scripts**
- [ ] **Create Automation Scripts**
  - *Tham chi·∫øu*: SRS-Grok-V2.md - Part15.2 CI/CD Pipelines
  - *M√¥ t·∫£*: Service setup, deployment, data management, ML model update scripts
  - *File t·∫°o*: `scripts/setup-redemption-service.sh`, `deploy-redemption-service.sh`, `migrate-database.sh`, `backup-redemption-data.sh`, `fraud-model-update.sh`
  - *√ù nghƒ©a*: Operational efficiency v√† consistency

---

## üìã **PACKAGE.JSON CHO REDEMPTION SERVICE**

```json
{
  "name": "redemption-transaction-service",
  "version": "1.0.0",
  "description": "PSP Redemption & Transaction Service v·ªõi Fraud Detection",
  "main": "dist/src/main.js",
  "scripts": {
    "build": "tsc",
    "start": "node dist/src/main.js",
    "start:dev": "ts-node-dev --respawn --transpile-only src/main.ts",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage",
    "test:e2e": "jest --config ./tests/e2e/jest-e2e.json",
    "lint": "eslint src/**/*.ts",
    "lint:fix": "eslint src/**/*.ts --fix",
    "prisma:generate": "prisma generate",
    "prisma:migrate": "prisma migrate dev",
    "prisma:deploy": "prisma migrate deploy",
    "docker:build": "docker build -t redemption-service .",
    "docker:run": "docker run -p 3003:3003 redemption-service"
  },
  "dependencies": {
    "@psp/shared-core": "^1.2.0",           // Logger, validation, crypto utilities
    "@psp/shared-events": "^1.1.0",         // Domain events contracts
    "@psp/shared-database": "^1.0.5",       // DB connection utilities
    "@nestjs/common": "^10.0.0",
    "@nestjs/core": "^10.0.0",
    "@nestjs/platform-express": "^10.0.0",
    "@nestjs/cqrs": "^10.0.0",
    "@nestjs/jwt": "^10.0.0",
    "@nestjs/passport": "^10.0.0",
    "@nestjs/swagger": "^7.0.0",
    "@nestjs/throttler": "^5.0.0",
    "@prisma/client": "^5.0.0",
    "bcryptjs": "^2.4.3",
    "class-transformer": "^0.5.1",
    "class-validator": "^0.14.0",
    "helmet": "^7.0.0",
    "joi": "^17.9.0",
    "passport": "^0.6.0",
    "passport-jwt": "^4.0.1",
    "redis": "^4.6.0",
    "rxjs": "^7.8.0",
    "uuid": "^9.0.0"
  },
  "devDependencies": {
    "@types/bcryptjs": "^2.4.2",
    "@types/jest": "^29.5.0",
    "@types/node": "^20.0.0",
    "@types/passport-jwt": "^3.0.8",
    "@types/uuid": "^9.0.0",
    "@typescript-eslint/eslint-plugin": "^6.0.0",
    "@typescript-eslint/parser": "^6.0.0",
    "eslint": "^8.0.0",
    "eslint-config-prettier": "^9.0.0",
    "eslint-plugin-prettier": "^5.0.0",
    "jest": "^29.5.0",
    "prettier": "^3.0.0",
    "prisma": "^5.0.0",
    "supertest": "^6.3.0",
    "ts-jest": "^29.1.0",
    "ts-node": "^10.9.0",
    "ts-node-dev": "^2.0.0",
    "typescript": "^5.0.0"
  },
  "jest": {
    "moduleFileExtensions": ["js", "json", "ts"],
    "rootDir": ".",
    "testRegex": ".*\\.test\\.ts$",
    "transform": {
      "^.+\\.(t|j)s$": "ts-jest"
    },
    "collectCoverageFrom": [
      "src/**/*.(t|j)s",
      "!src/**/*.test.(t|j)s",
      "!src/**/*.spec.(t|j)s"
    ],
    "coverageDirectory": "./coverage",
    "testEnvironment": "node",
    "coverageThreshold": {
      "global": {
        "branches": 80,
        "functions": 80,
        "lines": 80,
        "statements": 80
      }
    }
  },
  "keywords": [
    "redemption",
    "transaction",
    "fraud-detection",
    "barcode",
    "qr-code",
    "payment",
    "microservice",
    "nestjs",
    "prisma",
    "postgresql",
    "psp"
  ],
  "author": "PSP Development Team",
  "license": "MIT"
}
```

---

## üéØ **K·∫æT LU·∫¨N**

**T·ªïng s·ªë files ƒë∆∞·ª£c map**: 164 files v·ªõi ƒë·∫ßy ƒë·ªß SRS references  
**Backend Clean Architecture**: 89 files v·ªõi proper layering theo EMSA-v1.0  
**Shared Packages Integration**: 3 NPM packages cho cross-service utilities  
**API Coverage**: Complete REST endpoints cho Redemption, Transaction, Fraud Detection  
**Security Implementation**: 7 middleware files v·ªõi comprehensive security  
**ML Integration**: Advanced fraud detection v·ªõi machine learning scoring  
**Testing Strategy**: 37 test files coverage (Unit, Integration, E2E)  
**External Services**: 7 external service integrations (Scandit, Payment, ML, POS)  
**Deployment & DevOps**: 17 infrastructure files v·ªõi K8s + monitoring  
**Documentation**: 12 comprehensive docs cho development + operations  

**Estimated timeline**: 10-12 tu·∫ßn cho 1 team (4-5 developers)  
**SRS coverage**: 100% cho Redemption domain (FR-007, FR-011)  
**EMSA-v1.0 compliance**: Full compliance v·ªõi Clean Architecture standards  
**Integration points**: Ready cho Campaign, Identity, Analytics services integration  
**Advanced capabilities**: ML fraud detection, offline POS sync, device fingerprinting  
**Professional standards**: NPM packages approach, semantic versioning, CI/CD automation  

**Sub-Project 3 ho√†n ch·ªânh! Redemption & Transaction Service v·ªõi complete backend implementation, advanced fraud detection, v√† ML integration theo EMSA-v1.0 v√† SRS specifications! üöÄ**
